@model TicketVerkoop.ViewModels.ShoppingCartVM

@{
    ViewData["Title"] = "Index";
}
<link rel="stylesheet" href="~/css/ShoppingCartStyles.css" />
@{
    decimal total = 0;
}
<h3>Shopping kaart</h3>

@if (Model == null || (Model.Tickets == null && Model.Abonnementen == null))
{
    <p>Your shopping cart is empty.</p>
}
else
{   <div>
        @if (Model.Tickets != null && Model.Tickets.Count > 0)
        {
            <h4>Tickets in je kaart</h4>
            <table>
                <tr>
                    <th>Stadium</th>
                    <th>Stad</th>
                    <th>Thuisploeg</th>
                    <th>Uitploeg</th>
                    <th>Aantal Tickets</th>
                    <th>Ring</th>
                    <th>Section</th>
                    <th>Zitplaats(en) nr</th>
                    <th>Prijs</th>
                </tr>

                @foreach (var item in Model.Tickets)
                {
                    <tr>
                        <td>@item.StadiumNaam</td>
                        <td>@item.Stad</td>
                        <td>@item.ThuisPloegNaam</td>
                        <td>@item.UitPloegNaam</td>
                        <td>@item.aantaZitPlaatsen</td>
                        <th>@item.RingNaam</th>
                        <th>@item.SectionId</th>
                        <td><strong>Zit stoelen</strong></td>
                        <td>@item.Prijs, Eur</td>
                    </tr>

                    @if (item.Prijs != null)
                    {
                        total += decimal.Parse(item.Prijs);
                    }
                }
            </table>
        }

        @if (Model.Abonnementen != null && Model.Abonnementen.Count > 0)
        {
            <br />
            <br />
            <div class="row">
                <h4 class="centered">Abonnementen in je kaart</h4>
                <br />
                @foreach (var item in Model.Abonnementen)
                {
                    @await Html.PartialAsync("_AbonnementenPartialView", item)
                }
            </div>
@*             <h4>Abonnementen in je kaart</h4>
            <table>
                <tr>
                    <th>Ploegnaam</th>
                    <th>Stadianaam</th>
                    <th>Ring</th>
                    <th>Section</th>
                    <th>Zitplaats nr</th>
                    <th>Prijs, Eur</th>
                </tr>

                @foreach (var item in Model.Abonnementen)
                {
                    <tr>
                        <td>@item.PloegNaam</td>
                        <td>@item.StadiumNaam</td>
                        <td>@item.SelectedRingNaam</td>
                        <td>@item.SelectedSectiondId</td>
                        <td><strong>Zitstoel</strong></td>
                        <td>@item.Prijs</td> 
                    </tr>

                    @if (item.Prijs.HasValue)
                    {
                        total += item.Prijs.Value;
                    }
                }
            </table> *@
        }
        <p style="text-align: center; font-weight: bold;" id="totalePrijs">Total: @total.ToString("0.00") Eur</p>
    </div>
}
<br />
<form asp-controller="ShoppingCart" asp-action="Checkout" asp-method="post">
    <input type="hidden" id="totalPrijs" name="totalPrijs" value="@total" />
    <button type="submit" class="btn-lg btn-primary">Checkout</button>
</form><a asp-controller="Kalender" asp-action="Index" class="btn-lg btn-primary">Back to matches</a>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
